<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>e-net専用ログイン</title>

    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
        function handleLogin(response) {
            let data = null;

            try {
                // JWT デコード
                data = JSON.parse(atob(response.credential.split('.')[1]));
            } catch (e) {
                // デコード失敗 → gmail など email が取れないケース
                alert("このアカウントではログインできません。（メール情報なし）");
                return;
            }

            const email = data.email;
            if (!email) {
                alert("このアカウントではログインできません。（メールが取得できません）");
                return;
            }

            const domain = email.split("@")[1];

            if (domain === "e-net.nara.jp") {
                sessionStorage.setItem("e-net-auth", email);
                window.location.href = "home.html";
            } else {
                alert("このサイトは e-net.nara.jp のアカウント専用です。");
            }
        }

    </script>

<script id="dg-topbar-loader">
(function () {
  const firstSeg = (location.pathname.split("/")[1] || "").trim();
  const candidates = ["/assets/js/dg-topbar.js"];
  if (firstSeg) candidates.push("/" + firstSeg + "/assets/js/dg-topbar.js");

  function load(i) {
    if (i >= candidates.length) return;
    const s = document.createElement("script");
    s.src = candidates[i];
    s.defer = true;
    s.onerror = () => load(i + 1);
    document.head.appendChild(s);
  }

  load(0);
})();
</script>
</head>

<body>

    <h2>e-net アカウントでログイン</h2>

    <div id="g_id_onload" data-client_id="377931252827-5qj0kuet73lfq6f4ombtmclojfkarhhv.apps.googleusercontent.com"
        data-callback="handleLogin">
    </div>

    <div class="g_id_signin" data-type="standard" data-theme="outline" data-size="large">
    </div>

</body>

</html>