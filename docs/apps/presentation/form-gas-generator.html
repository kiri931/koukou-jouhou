<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Googleãƒ•ã‚©ãƒ¼ãƒ (GAS)ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï½œç›¸äº’è©•ä¾¡/è‡ªå·±è©•ä¾¡/æ•™å¸«è©•ä¾¡</title>
  <link rel="stylesheet" href="../../assets/css/digital.css" />
  <style>
    :root { --pr-max: 1200px; }

    /* ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒï¼ˆã“ã®ãƒšãƒ¼ã‚¸é™å®šï¼‰ */
    html[data-theme="dark"] {
      color-scheme: dark;
      --dg-color-bg: #0b0f14;
      --dg-color-surface: #0f172a;
      --dg-color-surface-2: #111827;
      --dg-color-border: #233047;
      --dg-color-text: #e5e7eb;
      --dg-color-muted: #9ca3af;
      --dg-color-link: #93c5fd;
      --dg-color-link-visited: #c4b5fd;
      --dg-color-primary: #60a5fa;
      --dg-color-primary-hover: #3b82f6;
      --dg-color-primary-active: #2563eb;
      --dg-color-on-primary: #0b1220;
      --dg-shadow-sm: 0 1px 2px rgba(0,0,0,.25);
      --dg-shadow-md: 0 10px 28px rgba(0,0,0,.35);
    }

    .pr-container { width: min(var(--pr-max), calc(100% - 32px)); margin: 0 auto; }

    .pr-grid {
      display: grid;
      grid-template-columns: 420px 1fr;
      gap: var(--dg-space-4);
      align-items: start;
    }
    @media (max-width: 1040px) {
      .pr-grid { grid-template-columns: 1fr; }
    }

    .pr-badges { display:flex; gap: 8px; flex-wrap: wrap; }
    .pr-badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--dg-color-surface);
      border: 1px solid var(--dg-color-border);
      color: var(--dg-color-muted);
      font-size: var(--dg-text-sm);
      line-height: 1.2;
    }

    .pr-modeBox { display: grid; gap: 10px; }
    .pr-modeBtn {
      appearance: none;
      border: 1px solid var(--dg-color-border);
      background: var(--dg-color-surface);
      color: inherit;
      text-align: left;
      border-radius: var(--dg-radius-md);
      padding: 10px 12px;
      cursor: pointer;
    }
    .pr-modeBtn:hover { background: var(--dg-color-surface-2); }
    .pr-modeBtn__title { font-weight: 800; }
    .pr-modeBtn__desc { color: var(--dg-color-muted); font-size: var(--dg-text-sm); margin-top: 2px; }

    .pr-inline { display:flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .pr-inline label { display:flex; gap: 8px; align-items: center; }

    .pr-grid2 { display:grid; grid-template-columns: 1fr 1fr; gap: var(--dg-space-3); }
    @media (max-width: 860px) { .pr-grid2 { grid-template-columns: 1fr; } }

    .pr-divider { height: 1px; background: var(--dg-color-border); margin: var(--dg-space-5) 0; }
    .pr-miniNote { color: var(--dg-color-muted); font-size: var(--dg-text-xs); margin-top: 6px; }

    .pr-codeArea {
      width: 100%;
      min-height: 340px;
      font-family: var(--dg-font-mono);
      font-size: 12px;
      line-height: 1.5;
    }

    details {
      border: 1px solid var(--dg-color-border);
      border-radius: var(--dg-radius-md);
      padding: 10px 12px;
      background: var(--dg-color-surface);
      margin-top: var(--dg-space-4);
    }
    summary { cursor: pointer; font-weight: 800; }
    summary span { font-weight: 600; color: var(--dg-color-muted); }

    .pr-items { display:flex; flex-direction:column; gap: 10px; margin-top: 10px; }
    .pr-item {
      border: 1px solid var(--dg-color-border);
      border-radius: var(--dg-radius-md);
      padding: 10px;
      background: color-mix(in srgb, var(--dg-color-surface), #fff 8%);
    }
    html[data-theme="dark"] .pr-item { background: color-mix(in srgb, var(--dg-color-surface), #000 12%); }

    .pr-itemTop { display:flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .pr-itemToggles { display:flex; gap: 10px; flex-wrap: wrap; color: var(--dg-color-muted); font-size: var(--dg-text-sm); }
    .pr-toggle { display:flex; gap: 6px; align-items: center; }
    .pr-itemGrid2 { display:grid; grid-template-columns: 1fr 1fr; gap: var(--dg-space-3); margin-top: var(--dg-space-3); }
    @media (max-width: 860px) { .pr-itemGrid2 { grid-template-columns: 1fr; } }

    .pr-toast {
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--dg-color-text);
      color: var(--dg-color-bg);
      border: 1px solid color-mix(in srgb, var(--dg-color-border), #000 10%);
      padding: 10px 12px;
      border-radius: 999px;
      box-shadow: var(--dg-shadow-md);
      display: none;
      z-index: 9999;
      font-size: var(--dg-text-sm);
    }

    @media print {
      .no-print { display: none !important; }
      .pr-toast { display: none !important; }
    }
  </style>
<script id="dg-topbar-loader">
(function () {
  const firstSeg = (location.pathname.split("/")[1] || "").trim();
  const candidates = ["/assets/js/dg-topbar.js"];
  if (firstSeg) candidates.push("/" + firstSeg + "/assets/js/dg-topbar.js");

  function load(i) {
    if (i >= candidates.length) return;
    const s = document.createElement("script");
    s.src = candidates[i];
    s.defer = true;
    s.onerror = () => load(i + 1);
    document.head.appendChild(s);
  }

  load(0);
})();
</script>
</head>

<body>
  <header class="dg-header no-print">
    <div class="pr-container dg-header__inner">
      <a class="dg-brand" href="./">
        <span class="dg-brand__title">ãƒ—ãƒ¬ã‚¼ãƒ³</span>
        <span class="dg-brand__badge">forms</span>
      </a>
      <nav class="dg-nav" aria-label="ãƒ„ãƒ¼ãƒ«ãƒãƒ¼">
        <a class="dg-btn dg-btn--subtle" href="./">æˆ»ã‚‹</a>
        <button id="btnTheme" class="dg-btn dg-btn--subtle" type="button">ãƒ©ã‚¤ãƒˆ/ãƒ€ãƒ¼ã‚¯</button>
      </nav>
    </div>
  </header>

  <main class="dg-main">
    <div class="pr-container">
      <h1 class="dg-page-title">Googleãƒ•ã‚©ãƒ¼ãƒ (GAS)ç”Ÿæˆãƒ„ãƒ¼ãƒ«</h1>
      <p class="dg-lead">è¨­å®šã‚’æ•´ãˆã¦ã€ŒGASç”¨ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã€â†’ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã® Apps Script ã«è²¼ã‚Šä»˜ã‘ã¦å®Ÿè¡Œ â†’ ãƒ•ã‚©ãƒ¼ãƒ URLãŒå‡ºã¾ã™ã€‚</p>

      <div class="pr-grid">
        <!-- Left: settings -->
        <section class="dg-card">
          <div class="dg-card__body dg-prose">
            <h2 style="margin-top:0">â‘  ã¾ãšä½œã‚‹ç¨®é¡ã‚’é¸ã¶</h2>
            <div class="pr-modeBox" id="modeBox"></div>

            <div class="pr-divider"></div>

            <h2 style="margin-top:0">â‘¡ ãƒ•ã‚©ãƒ¼ãƒ ã®åŸºæœ¬è¨­å®š</h2>
            <div class="dg-field">
              <label class="dg-label" for="formTitle">ãƒ•ã‚©ãƒ¼ãƒ ã‚¿ã‚¤ãƒˆãƒ«</label>
              <input id="formTitle" class="dg-input" type="text" />
            </div>

            <div class="dg-field">
              <label class="dg-label" for="formDesc">ãƒ•ã‚©ãƒ¼ãƒ èª¬æ˜ï¼ˆä»»æ„ï¼‰</label>
              <textarea id="formDesc" class="dg-textarea" placeholder="ä¾‹ï¼‰ã‚¹ãƒ©ã‚¤ãƒ‰URLã¯å…ˆç”ŸãŒè¦‹ã‚‰ã‚Œã‚‹å…±æœ‰è¨­å®šã§â€¦"></textarea>
            </div>

            <div class="pr-grid2">
              <div class="dg-field">
                <label class="dg-label" for="linkSheetName">ãƒªãƒ³ã‚¯å‡ºåŠ›ã‚·ãƒ¼ãƒˆå</label>
                <input id="linkSheetName" class="dg-input" type="text" />
                <div class="pr-miniNote">ç”Ÿæˆå¾Œã€ã“ã“ã« <b>publishedUrl / editUrl</b> ã‚’æ›¸ãå‡ºã—ã¾ã™ã€‚</div>
              </div>
              <div class="dg-field">
                <label class="dg-label" for="confirmMsg">ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆé€ä¿¡å¾Œè¡¨ç¤ºï¼‰</label>
                <input id="confirmMsg" class="dg-input" type="text" />
              </div>
            </div>

            <div class="pr-inline" style="margin-top: var(--dg-space-4);">
              <label><input id="forceLogin" type="checkbox" /> Googleãƒ­ã‚°ã‚¤ãƒ³ã‚’å¼·åˆ¶ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ­ã‚°ã‚¤ãƒ³ã§å–å¾—ï¼‰</label>
            </div>
            <div class="pr-miniNote">â€» ç’°å¢ƒå·®ãŒã‚ã‚‹ãŸã‚ã€ç”Ÿæˆã‚³ãƒ¼ãƒ‰ã¯ <b>try/catch</b> ã§å®‰å…¨ã«å‡¦ç†ã—ã¾ã™ã€‚</div>

            <div class="pr-divider"></div>

            <h2 style="margin-top:0">â‘¢ GASã‚’ç”Ÿæˆ</h2>
            <div class="dg-row">
              <button id="btnGenerate" class="dg-btn" type="button">GASç”¨ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ</button>
              <button id="btnCopy" class="dg-btn dg-btn--subtle" type="button">ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼</button>
              <button id="btnReset" class="dg-btn dg-btn--subtle" type="button">ãƒ†ãƒ³ãƒ—ãƒ¬ã«æˆ»ã™</button>
            </div>

            <div class="dg-field" style="margin-top: var(--dg-space-4);">
              <label class="dg-label" for="codeOut">ç”Ÿæˆã•ã‚ŒãŸGASã‚³ãƒ¼ãƒ‰ï¼ˆãã®ã¾ã¾è²¼ã‚Šä»˜ã‘OKï¼‰</label>
              <textarea id="codeOut" class="dg-textarea pr-codeArea" spellcheck="false"></textarea>
            </div>

            <div class="pr-miniNote">â€» ã“ã®ãƒšãƒ¼ã‚¸ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ãã€Œã‚³ãƒ¼ãƒ‰ç”Ÿæˆå™¨ã€ã§ã™ã€‚ç”Ÿæˆã•ã‚ŒãŸGASã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆå´ã§å®Ÿè¡Œã™ã‚‹ã¨ãƒ•ã‚©ãƒ¼ãƒ ãŒä½œæˆã•ã‚Œã¾ã™ã€‚</div>
          </div>
        </section>

        <!-- Right: question editor -->
        <section class="dg-card">
          <div class="dg-card__body dg-prose">
            <h2 style="margin-top:0">è³ªå•é …ç›®ã®ç·¨é›†</h2>
            <div class="pr-badges">
              <span class="pr-badge">å‰Šé™¤OKï¼ˆä½¿ã†OFFï¼‰</span>
              <span class="pr-badge">å¿…é ˆON/OFF</span>
              <span class="pr-badge">è©•ä¾¡é …ç›®ã¯Â±ã§å¢—æ¸›</span>
            </div>

            <details open>
              <summary>åŸºæœ¬é …ç›® <span>ï¼ˆå‡ºå¸­ç•ªå·ãƒ»åå‰ãªã©ï¼‰</span></summary>
              <div class="pr-items" id="basicItems"></div>
            </details>

            <details id="sampleSection" open>
              <summary>ã‚µãƒ³ãƒ—ãƒ«ç›¸äº’è©•ä¾¡ <span>ï¼ˆã¯ã„/ã„ã„ãˆï¼‰</span></summary>
              <div class="pr-inline" style="margin-top: var(--dg-space-3);">
                <label><input id="useSample" type="checkbox" /> ã‚µãƒ³ãƒ—ãƒ«ã®ç›¸äº’è©•ä¾¡ã‚’åˆ©ç”¨ã™ã‚‹</label>
              </div>
              <div class="pr-items" id="sampleItems"></div>
            </details>

            <details open>
              <summary>ç‚¹æ•°ï¼ˆã‚¹ã‚±ãƒ¼ãƒ«ï¼‰è©•ä¾¡é …ç›® <span>ï¼ˆè©•ä¾¡é …ç›®1ã€œ / ä¸‹é™0 or 1 / ä¸Šé™3ã€œ10ï¼‰</span></summary>

              <div class="dg-row" style="justify-content: space-between; margin-top: var(--dg-space-3);">
                <div class="pr-miniNote">â€» ã‚¹ã‚±ãƒ¼ãƒ«åˆ¶ç´„ï¼šä¸‹é™ã¯ <b>0 ã¾ãŸã¯ 1</b>ã€ä¸Šé™ã¯ <b>3ã€œ10</b></div>
                <div class="dg-row">
                  <button id="btnAddRating" class="dg-btn dg-btn--subtle" type="button">ï¼‹ è¿½åŠ </button>
                  <button id="btnRemoveRating" class="dg-btn dg-btn--subtle" type="button">âˆ’ å‰Šé™¤</button>
                </div>
              </div>

              <div class="pr-items" id="ratingItems"></div>
            </details>

            <details open>
              <summary>è‡ªç”±è¨˜è¿° <span>ï¼ˆè‰¯ã‹ã£ãŸç‚¹ / æ‚ªã‹ã£ãŸç‚¹ / ã‚³ãƒ¡ãƒ³ãƒˆï¼‰</span></summary>
              <div class="pr-items" id="freeItems"></div>
            </details>

            <details>
              <summary>é«˜åº¦ãªè¨­å®š <span>ï¼ˆé¸æŠè‚¢ã®ç·¨é›†ãªã©ï¼‰</span></summary>
              <ul class="pr-miniNote" style="margin: 10px 0 0 1.2em; padding: 0;">
                <li>ã¯ã„/ã„ã„ãˆã‚’åˆ¥ã®é¸æŠè‚¢ã«å¤‰ãˆãŸã„å ´åˆã¯ã€å„é …ç›®ã®ã€Œé¸æŠè‚¢ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰ã€ã‚’ç·¨é›†ã—ã¦ãã ã•ã„ã€‚</li>
                <li>èª¬æ˜æ–‡ï¼ˆHelpTextï¼‰ã‚‚å„é …ç›®ã§ç·¨é›†ã§ãã¾ã™ã€‚</li>
              </ul>
            </details>

            <div class="pr-divider"></div>

            <h2 style="margin-top:0">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§å®Ÿè¡Œã™ã‚‹ã¾ã§ã®æ‰‹é †ï¼ˆä¸å¯§ç‰ˆï¼‰</h2>
            <ol style="font-size: var(--dg-text-sm)">
              <li>ã¾ãšã“ã®ãƒšãƒ¼ã‚¸ã§è¨­å®šã‚’æ•´ãˆã€å·¦å´ã® <b>ã€ŒGASç”¨ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã€</b> ã‚’æŠ¼ã—ã¾ã™ã€‚</li>
              <li><b>Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</b>ã‚’é–‹ãã¾ã™ï¼ˆå›ç­”ã‚’ä¿å­˜ã—ãŸã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼‰ã€‚</li>
              <li>ä¸Šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® <b>æ‹¡å¼µæ©Ÿèƒ½ â†’ Apps Script</b> ã‚’é–‹ãã¾ã™ã€‚</li>
              <li>è¡¨ç¤ºã•ã‚ŒãŸ <b>Code.gs</b> ã«ã€ã“ã“ã§ç”Ÿæˆã—ãŸGASã‚³ãƒ¼ãƒ‰ã‚’ <b>å…¨éƒ¨è²¼ã‚Šä»˜ã‘</b>ã€ä¿å­˜ï¼ˆğŸ’¾ï¼‰ã—ã¾ã™ã€‚</li>
              <li>Apps Scriptä¸Šéƒ¨ã®é–¢æ•°é¸æŠã§ <b>createEvaluationForm</b> ã‚’é¸ã³ã€â–¶ï¸å®Ÿè¡Œã—ã¾ã™ã€‚</li>
              <li>åˆå›ã¯æ¨©é™ãŒå¿…è¦ã§ã™ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠ â†’ è¨±å¯ï¼ˆãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ/ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç·¨é›†ï¼‰ã€‚</li>
              <li>å®Ÿè¡ŒãŒæˆåŠŸã™ã‚‹ã¨ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã« <b>ãƒªãƒ³ã‚¯å‡ºåŠ›ã‚·ãƒ¼ãƒˆï¼ˆä¾‹ï¼šFormLinksï¼‰</b> ãŒä½œã‚‰ã‚Œã€2è¡Œç›®ã« <b>publishedUrlï¼ˆæå‡ºç”¨ãƒªãƒ³ã‚¯ï¼‰</b> ã¨ <b>editUrlï¼ˆç·¨é›†ç”¨ï¼‰</b> ãŒå‡ºã¾ã™ã€‚</li>
              <li>ç”Ÿå¾’ã«é…ã‚‹ã®ã¯ <b>publishedUrl</b> ã§ã™ï¼ˆGoogle Classroom ç­‰ã«è²¼ã‚‹ï¼‰ã€‚</li>
              <li>ã€Œã‚¹ãƒ©ã‚¤ãƒ‰URLã‚’æå‡ºã•ã›ã‚‹ã€é‹ç”¨ãªã‚‰ã€ã‚¹ãƒ©ã‚¤ãƒ‰ã®å…±æœ‰è¨­å®šã¯ <b>å…ˆç”ŸãŒé–²è¦§ã§ãã‚‹</b> ã‚ˆã†ã«æ³¨æ„å–šèµ·ã—ã¦ãã ã•ã„ã€‚</li>
            </ol>

            <div class="pr-miniNote">â€» ç”Ÿæˆã‚³ãƒ¼ãƒ‰ã¯ <b>FormApp.create()</b> ã§ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆã€<b>setDestination()</b> ã§å›ç­”ä¿å­˜å…ˆã‚’ã“ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è¨­å®šã—ã€æœ€å¾Œã«URLã‚’æ›¸ãå‡ºã—ã¾ã™ã€‚</div>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer class="dg-footer">
    <div class="pr-container dg-footer__inner">
      <div class="dg-footer__meta">Â© ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆæˆæ¥­ç”¨ï¼šGASã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«</div>
      <div class="dg-row">
        <a class="dg-btn dg-btn--subtle" href="./submit-links.html">æå‡ºç”¨ãƒªãƒ³ã‚¯ç®¡ç†</a>
      </div>
    </div>
  </footer>

  <div class="pr-toast" id="toast" role="status" aria-live="polite"></div>

  <script defer src="./form-gas-generator.js"></script>
</body>
</html>
